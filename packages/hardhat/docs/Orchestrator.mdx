# Solidity API

## Orchestrator_UnableToCompleteDelegateCall

```solidity
error Orchestrator_UnableToCompleteDelegateCall(bytes delegateError)
```

error emitted when a delegatecall fails

## Orchestrator_InvalidAmount

```solidity
error Orchestrator_InvalidAmount()
```

error emitted when the balance input is smaller than the specified amount param

## Orchestrator_OnlyRouterCanFulfill

```solidity
error Orchestrator_OnlyRouterCanFulfill()
```

error emitted when a address non-router calls the `handleOracleFulfillment` function

## Orchestrator_InvalidBridgeData

```solidity
error Orchestrator_InvalidBridgeData()
```

error emitted when some params of Bridge Data are empty

## Orchestrator_InvalidSwapData

```solidity
error Orchestrator_InvalidSwapData()
```

error emitted when an empty swapData is the input

## Orchestrator_InvalidBridgeToken

```solidity
error Orchestrator_InvalidBridgeToken()
```

error emitted when the token to bridge is not USDC

## Orchestrator

### CONCERO_FEE_FACTOR

```solidity
uint16 CONCERO_FEE_FACTOR
```

CONSTANTS///

### i_functionsRouter

```solidity
address i_functionsRouter
```

the address of Functions router

### i_dexSwap

```solidity
address i_dexSwap
```

variable to store the DexSwap address

### i_concero

```solidity
address i_concero
```

variable to store the Concero address

### i_pool

```solidity
address i_pool
```

variable to store the ConceroPool address

### i_proxy

```solidity
address i_proxy
```

variable to store the immutable Proxy Address

### i_chainIndex

```solidity
enum IStorage.Chain i_chainIndex
```

ID of the deployed chain on getChain() function

### Orchestrator_RequestFulfilled

```solidity
event Orchestrator_RequestFulfilled(bytes32 requestId)
```

emitted when the Functions router fulfills a request

### Orchestrator_SwapSuccess

```solidity
event Orchestrator_SwapSuccess()
```

emitted if swap successed

### Orchestrator_StartBridge

```solidity
event Orchestrator_StartBridge()
```

### Orchestrator_StartSwapAndBridge

```solidity
event Orchestrator_StartSwapAndBridge()
```

### Orchestrator_StartSwap

```solidity
event Orchestrator_StartSwap()
```

### constructor

```solidity
constructor(address _functionsRouter, address _dexSwap, address _concero, address _pool, address _proxy, uint8 _chainIndex, address[3] _messengers) public
```

### receive

```solidity
receive() external payable
```

### tokenAmountSufficiency

```solidity
modifier tokenAmountSufficiency(address token, uint256 amount)
```

MODIFIERS///

### validateBridgeData

```solidity
modifier validateBridgeData(struct IStorage.BridgeData _bridgeData)
```

### validateSrcSwapData

```solidity
modifier validateSrcSwapData(struct IDexSwap.SwapData[] _swapData)
```

### validateDstSwapData

```solidity
modifier validateDstSwapData(struct IDexSwap.SwapData[] _swapData, struct IStorage.BridgeData _bridgeData)
```

### getSrcTotalFeeInUSDC

```solidity
function getSrcTotalFeeInUSDC(enum IStorage.CCIPToken tokenType, uint64 dstChainSelector, uint256 amount) external view returns (uint256)
```

Function to get the total bridge fee in USDC

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| tokenType | enum IStorage.CCIPToken | the token type |
| dstChainSelector | uint64 | the destination chain selector |
| amount | uint256 | the amount to be bridged |

#### Return Values

| Name | Type | Description |
| ---- | ---- | ----------- |
| [0] | uint256 | the total fee in USDC |

### getSrcTotalFeeInUSDCViaDelegateCall

```solidity
function getSrcTotalFeeInUSDCViaDelegateCall(enum IStorage.CCIPToken tokenType, uint64 dstChainSelector, uint256 amount) external returns (uint256)
```

### swapAndBridge

```solidity
function swapAndBridge(struct IStorage.BridgeData bridgeData, struct IDexSwap.SwapData[] srcSwapData, struct IDexSwap.SwapData[] dstSwapData) external payable
```

Performs a bridge coupled with the source chain swap and an optional destination chain swap.

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| bridgeData | struct IStorage.BridgeData | bridge payload of type BridgeData |
| srcSwapData | struct IDexSwap.SwapData[] | swap payload for the source chain of type IDexSwap.SwapData[] |
| dstSwapData | struct IDexSwap.SwapData[] | swap payload for the destination chain of type IDexSwap.SwapData[]. May be empty |

### swap

```solidity
function swap(struct IDexSwap.SwapData[] _swapData, address _receiver) external payable
```

Performs a swap on a single chain.

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| _swapData | struct IDexSwap.SwapData[] | the swap payload of type IDexSwap.SwapData[] |
| _receiver | address | the recipient of the swap |

### bridge

```solidity
function bridge(struct IStorage.BridgeData bridgeData, struct IDexSwap.SwapData[] dstSwapData) external payable
```

Performs a bridge from the source chain to the destination chain.

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| bridgeData | struct IStorage.BridgeData | bridge payload of type BridgeData |
| dstSwapData | struct IDexSwap.SwapData[] | destination swap payload. May be empty |

### addUnconfirmedTX

```solidity
function addUnconfirmedTX(bytes32 ccipMessageId, address sender, address recipient, uint256 amount, uint64 srcChainSelector, enum IStorage.CCIPToken token, uint256 blockNumber, bytes dstSwapData) external
```

Wrapper function to delegate call to ConceroBridge.addUnconfirmedTX

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| ccipMessageId | bytes32 | the CCIP message ID to be added on destination |
| sender | address | the address of the sender |
| recipient | address | the address of recipient of the bridge transaction |
| amount | uint256 | the amount to be bridged |
| srcChainSelector | uint64 | the CCIP chain selector of source chain |
| token | enum IStorage.CCIPToken | the address of the token |
| blockNumber | uint256 | the transaction block number |
| dstSwapData | bytes | the swap data to perform, if it's not empty |

### handleOracleFulfillment

```solidity
function handleOracleFulfillment(bytes32 requestId, bytes response, bytes err) external
```

Helper function to delegate call to ConceroBridge contract

_response and error will never be populated at the same time._

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| requestId | bytes32 | the CLF request ID from callback |
| response | bytes | the response |
| err | bytes | the error |

### withdraw

```solidity
function withdraw(address recipient, address token, uint256 amount) external payable
```

Function to allow Concero Team to withdraw fees

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| recipient | address | the recipient address |
| token | address | the token to withdraw |
| amount | uint256 | the amount to withdraw |

### _swap

```solidity
function _swap(struct IDexSwap.SwapData[] swapData, uint256 _nativeAmount, bool isTakingConceroFee, address _receiver) internal returns (uint256)
```

Internal function to perform swaps. Delegate calls DexSwap.entrypoint

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| swapData | struct IDexSwap.SwapData[] | the payload to be passed to swap functions |
| _nativeAmount | uint256 | the native amount entered on the external function |
| isTakingConceroFee | bool | flag to indicate when take fees |
| _receiver | address | the address of the receiver of the swap |

### _startBridge

```solidity
function _startBridge(struct IStorage.BridgeData bridgeData, struct IDexSwap.SwapData[] _dstSwapData) internal
```

### _getUSDCAddressByChainSelector

```solidity
function _getUSDCAddressByChainSelector(uint64 _chainSelector) internal pure returns (address _token)
```

### getTransaction

```solidity
function getTransaction(bytes32 _ccipMessageId) external view returns (struct IStorage.Transaction transaction)
```

VIEW & PURE FUNCTIONS///

